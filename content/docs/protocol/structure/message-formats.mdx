---
title: Message Formats
description: Standardized message structures for agent communication
icon: MessageSquare
---

import { Callout } from "fumadocs-ui/components/callout";

The H.I.V.E. Protocol uses standardized message formats to ensure consistent and interoperable communication between
agents. This document defines the structure and types of messages used throughout the protocol.

## Message Structure

All H.I.V.E. Protocol messages follow a common base structure:

```json
{
  "messageId": "msg-123456789",
  "messageType": "MESSAGE_TYPE",
  "timestamp": "2025-07-18T14:30:15.123Z",
  "sender": {
    "id": "agent-abc123",
    "publicKey": "-----BEGIN PUBLIC KEY-----\n...\n-----END PUBLIC KEY-----"
  },
  "recipient": {
    "id": "agent-xyz789",
    "publicKey": "-----BEGIN PUBLIC KEY-----\n...\n-----END PUBLIC KEY-----"
  },
  "payload": { /* Message-specific content */ },
  "signature": "Base64-encoded signature"
}
```

### Common Fields

| Field | Type | Description |
| ----- | ---- | ----------- |
| `messageId` | String | Unique identifier for the message |
| `messageType` | String | Indicates the type and purpose of the message |
| `timestamp` | ISO 8601 DateTime | When the message was created |
| `sender` | Object | Information about the message sender |
| `sender.id` | String | Unique identifier of the sender agent |
| `sender.publicKey` | String | Public key of the sender (can be abbreviated in logs) |
| `recipient` | Object | Information about the message recipient |
| `recipient.id` | String | Unique identifier of the recipient agent |
| `recipient.publicKey` | String | Public key of the recipient (can be abbreviated in logs) |
| `payload` | Object | Message-specific content that varies by message type |
| `signature` | String | Cryptographic signature of the message content |

<Callout type="info">
  The `signature` is generated by signing all other fields of the message using the sender's private key.
    This ensures message authenticity and integrity.
</Callout>

## Message Types

The H.I.V.E. Protocol defines several message types to handle different aspects of agent communication and collaboration.

### Discovery Messages

#### CAPABILITY_ADVERTISEMENT

Used by agents to advertise their capabilities to others.

```json
{
  "messageId": "msg-123456789",
  "messageType": "CAPABILITY_ADVERTISEMENT",
  "timestamp": "2025-07-18T14:30:15.123Z",
  "sender": { /* sender details */ },
  "recipient": { /* recipient details or null for broadcast */ },
  "payload": {
    "capabilities": [
      {
        "id": "text-translation",
        "version": "1.0",
        "description": "Translates text between languages",
        "supportedLanguages": ["en", "es", "fr", "de"],
        "parameters": {
          "sourceLanguage": {
            "type": "string",
            "required": true
          },
          "targetLanguage": {
            "type": "string",
            "required": true
          },
          "text": {
            "type": "string",
            "required": true,
            "maxLength": 10000
          }
        },
        "returns": {
          "translatedText": {
            "type": "string"
          }
        }
      }
    ],
    "endpoints": {
      "http": "https://agent-abc123.example.com/api",
      "websocket": "wss://agent-abc123.example.com/ws"
    },
    "availability": {
      "status": "AVAILABLE",
      "loadFactor": 0.3,
      "maxConcurrentTasks": 100
    }
  },
  "signature": "Base64-encoded signature"
}
```

#### CAPABILITY_QUERY

Used to request capability information from another agent.

```json
{
  "messageId": "msg-987654321",
  "messageType": "CAPABILITY_QUERY",
  "timestamp": "2025-07-18T14:35:22.456Z",
  "sender": { /* sender details */ },
  "recipient": { /* recipient details */ },
  "payload": {
    "queryType": "SPECIFIC",
    "capabilityIds": ["text-translation", "image-generation"],
    "includeParameters": true
  },
  "signature": "Base64-encoded signature"
}
```

### Task Messages

#### TASK_PROPOSAL

Initiates a task by proposing it to a provider agent.

```json
{
  "messageId": "msg-task-proposal-123",
  "messageType": "TASK_PROPOSAL",
  "timestamp": "2025-07-18T15:00:00.000Z",
  "sender": { /* sender details */ },
  "recipient": { /* recipient details */ },
  "payload": {
    "taskId": "task-123456",
    "capabilityId": "text-translation",
    "priority": "NORMAL",
    "parameters": {
      "sourceLanguage": "en",
      "targetLanguage": "es",
      "text": "Hello world, this is a test message."
    },
    "constraints": {
      "deadline": "2025-07-18T15:10:00.000Z",
      "maxRetries": 2
    }
  },
  "signature": "Base64-encoded signature"
}
```

#### TASK_RESPONSE

Responds to a task proposal with acceptance, rejection, or a counter-proposal.

```json
{
  "messageId": "msg-task-response-456",
  "messageType": "TASK_RESPONSE",
  "timestamp": "2025-07-18T15:01:30.000Z",
  "sender": { /* sender details */ },
  "recipient": { /* recipient details */ },
  "payload": {
    "taskId": "task-123456",
    "responseType": "ACCEPT",
    "estimatedCompletionTime": "2025-07-18T15:05:00.000Z",
    "contractId": "contract-789012"
  },
  "signature": "Base64-encoded signature"
}
```

#### TASK_UPDATE

Provides status updates for a task in progress.

```json
{
  "messageId": "msg-task-update-789",
  "messageType": "TASK_UPDATE",
  "timestamp": "2025-07-18T15:03:45.000Z",
  "sender": { /* sender details */ },
  "recipient": { /* recipient details */ },
  "payload": {
    "taskId": "task-123456",
    "contractId": "contract-789012",
    "status": "IN_PROGRESS",
    "progress": 0.75,
    "estimatedCompletionTime": "2025-07-18T15:04:30.000Z",
    "message": "Translation 75% complete"
  },
  "signature": "Base64-encoded signature"
}
```

#### TASK_RESULT

Delivers the results of a completed task.

```json
{
  "messageId": "msg-task-result-012",
  "messageType": "TASK_RESULT",
  "timestamp": "2025-07-18T15:05:15.000Z",
  "sender": { /* sender details */ },
  "recipient": { /* recipient details */ },
  "payload": {
    "taskId": "task-123456",
    "contractId": "contract-789012",
    "status": "COMPLETED",
    "result": {
      "translatedText": "Hola mundo, este es un mensaje de prueba."
    },
    "metadata": {
      "processingTime": 3.45,
      "modelVersion": "spanish-translation-v2.1"
    }
  },
  "signature": "Base64-encoded signature"
}
```

#### TASK_ERROR

Reports an error that occurred during task execution.

```json
{
  "messageId": "msg-task-error-345",
  "messageType": "TASK_ERROR",
  "timestamp": "2025-07-18T15:02:10.000Z",
  "sender": { /* sender details */ },
  "recipient": { /* recipient details */ },
  "payload": {
    "taskId": "task-123456",
    "contractId": "contract-789012",
    "status": "FAILED",
    "error": {
      "code": "RESOURCE_UNAVAILABLE",
      "message": "Translation model for Spanish is temporarily unavailable",
      "details": {
        "expectedResolution": "2025-07-18T16:00:00.000Z",
        "alternativeAction": "Try different target language or retry later"
      }
    }
  },
  "signature": "Base64-encoded signature"
}
```

### Control Messages

#### ACKNOWLEDGMENT

Confirms receipt of a message, often used for important communications.

```json
{
  "messageId": "msg-ack-678",
  "messageType": "ACKNOWLEDGMENT",
  "timestamp": "2025-07-18T15:05:17.000Z",
  "sender": { /* sender details */ },
  "recipient": { /* recipient details */ },
  "payload": {
    "acknowledgedMessageId": "msg-task-result-012",
    "status": "RECEIVED"
  },
  "signature": "Base64-encoded signature"
}
```

#### HEARTBEAT

Sent periodically to indicate agent availability and health status.

```json
{
  "messageId": "msg-heartbeat-901",
  "messageType": "HEARTBEAT",
  "timestamp": "2025-07-18T15:10:00.000Z",
  "sender": { /* sender details */ },
  "recipient": { /* recipient details or null for broadcast */ },
  "payload": {
    "status": "AVAILABLE",
    "load": 0.4,
    "uptime": 86400,
    "availableCapabilities": ["text-translation", "image-generation"]
  },
  "signature": "Base64-encoded signature"
}
```

## Message Validation

All H.I.V.E. Protocol messages must be validated upon receipt:

1. **Structural Validation**: Ensure the message follows the correct format with all required fields
2. **Signature Verification**: Verify the message signature using the sender's public key
3. **Timestamp Check**: Ensure the message timestamp is within an acceptable range to prevent replay attacks
4. **Content Validation**: Validate payload content according to message-specific rules

<Callout type="warning">
  Messages that fail validation should be rejected with an appropriate error response. Never process messages with
    invalid signatures or suspicious timestamps.
</Callout>

## Error Handling

When errors occur during message processing, agents should respond with appropriate error messages:

```json
{
  "messageId": "msg-error-234",
  "messageType": "ERROR_RESPONSE",
  "timestamp": "2025-07-18T15:11:30.000Z",
  "sender": { /* sender details */ },
  "recipient": { /* recipient details */ },
  "payload": {
    "referenceMessageId": "msg-task-proposal-999",
    "errorCode": "INVALID_MESSAGE_FORMAT",
    "errorMessage": "Required field 'parameters' is missing",
    "details": {
      "validationErrors": [
        {
          "field": "payload.parameters",
          "error": "field is required"
        }
      ]
    }
  },
  "signature": "Base64-encoded signature"
}
```

<Callout type="info">
  For a complete list of error codes and their meanings, refer to the [Error Codes](/docs/protocol/structure/error-codes) documentation.
</Callout>

## Implementation Considerations

When implementing message handling, consider the following best practices:

- Use a message queue to handle high volumes of messages
- Implement proper error handling for malformed messages
- Include sufficient logging for debugging and audit purposes
- Consider message compression for large payloads
- Implement message deduplication to handle potential duplicates
- Use appropriate timeout mechanisms for expected responses
