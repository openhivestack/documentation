---
title: Task Lifecycle
description: The complete lifecycle of tasks from proposal to completion
icon: LifeBuoy
---

import { Callout } from "fumadocs-ui/components/callout";
import { Mermaid } from "@/components/mdx/mermaid";

The Task Lifecycle in the H.I.V.E. Protocol defines how tasks progress from initial proposal to final completion.
This standardized workflow ensures that all agents have a consistent understanding of task states and transitions.

## Task States Overview

<Mermaid
  chart={`
stateDiagram-v2
    [*] --> PROPOSED
    PROPOSED --> ACCEPTED: Provider accepts
    PROPOSED --> REJECTED: Provider rejects
    ACCEPTED --> IN_PROGRESS: Work begins
    IN_PROGRESS --> COMPLETED: Success
    IN_PROGRESS --> FAILED: Error
    IN_PROGRESS --> CANCELED: Mutual agreement
    COMPLETED --> [*]
    FAILED --> [*]
    REJECTED --> [*]
    CANCELED --> [*]
`}
/>

## Detailed Task States

### PROPOSED

The initial state when a task is first proposed by a requester agent to a provider agent.

**Characteristics:**
- Task details and requirements are specified
- No commitment has been made by the provider
- May include proposed deadline and constraints

**Possible Transitions:**
- → ACCEPTED: Provider agrees to perform the task
- → REJECTED: Provider declines to perform the task

### ACCEPTED

The provider has agreed to perform the task according to the specified requirements.

**Characteristics:**
- Contract between requester and provider is established
- Resources are allocated by the provider
- Expected completion time may be communicated

**Possible Transitions:**
- → IN_PROGRESS: Provider begins working on the task
- → CANCELED: Task is canceled before work begins

### IN_PROGRESS

The provider is actively working on the task.

**Characteristics:**
- Provider sends periodic progress updates
- Percentage completion may be reported
- Intermediate results may be shared

**Possible Transitions:**
- → COMPLETED: Task is successfully completed
- → FAILED: Task encounters an unrecoverable error
- → CANCELED: Task is canceled during execution

### COMPLETED

The task has been successfully completed and results have been delivered.

**Characteristics:**
- Final results are available
- All requirements have been met
- Verification may be performed by the requester

**Possible Transitions:**
- (Terminal state)

### FAILED

The task could not be completed due to errors or other issues.

**Characteristics:**
- Error details are provided
- Reason for failure is documented
- Recovery options may be suggested

**Possible Transitions:**
- (Terminal state)

### REJECTED

The provider has declined to accept the task proposal.

**Characteristics:**
- Reason for rejection is provided
- Alternative providers may be suggested
- Parameters for reconsideration may be offered

**Possible Transitions:**
- (Terminal state)

### CANCELED

The task was canceled after being accepted or started.

**Characteristics:**
- Reason for cancellation is documented
- Cancellation may be initiated by either party
- Partial results may be provided if available

**Possible Transitions:**
- (Terminal state)

## Task Lifecycle Flow

### 1. Task Proposal

The lifecycle begins when a requester agent proposes a task to a provider agent.

```json
{
  "messageType": "TASK_PROPOSAL",
  "payload": {
    "taskId": "task-123456",
    "capabilityId": "text-translation",
    "parameters": {
      "sourceLanguage": "en",
      "targetLanguage": "es",
      "text": "Hello world, this is a test message."
    },
    "requirements": {
      "deadline": "2025-07-18T15:00:00Z",
      "priority": "NORMAL"
    }
  }
}
```

### 2. Task Acceptance or Rejection

The provider evaluates the proposal and decides whether to accept or reject it.

```json
// Acceptance
{
  "messageType": "TASK_RESPONSE",
  "payload": {
    "taskId": "task-123456",
    "responseType": "ACCEPT",
    "estimatedCompletionTime": "2025-07-18T14:45:00Z",
    "contractId": "contract-789012"
  }
}

// Rejection
{
  "messageType": "TASK_RESPONSE",
  "payload": {
    "taskId": "task-123456",
    "responseType": "REJECT",
    "reason": "CAPABILITY_UNAVAILABLE",
    "message": "Spanish translation service currently unavailable",
    "alternatives": [
      {
        "capabilityId": "text-translation",
        "parameters": {
          "sourceLanguage": "en",
          "targetLanguage": "fr"
        },
        "availability": "AVAILABLE"
      }
    ]
  }
}
```

### 3. Task Execution

If accepted, the provider begins executing the task and updates the requester on progress.

```json
// Starting execution
{
  "messageType": "TASK_UPDATE",
  "payload": {
    "taskId": "task-123456",
    "contractId": "contract-789012",
    "status": "IN_PROGRESS",
    "progress": 0.0,
    "message": "Translation starting",
    "timestamp": "2025-07-18T14:30:00Z"
  }
}

// Progress update
{
  "messageType": "TASK_UPDATE",
  "payload": {
    "taskId": "task-123456",
    "contractId": "contract-789012",
    "status": "IN_PROGRESS",
    "progress": 0.75,
    "message": "Translation 75% complete",
    "timestamp": "2025-07-18T14:40:00Z"
  }
}
```

### 4. Task Completion or Failure

The task either completes successfully or fails with an error.

```json
// Successful completion
{
  "messageType": "TASK_RESULT",
  "payload": {
    "taskId": "task-123456",
    "contractId": "contract-789012",
    "status": "COMPLETED",
    "result": {
      "translatedText": "Hola mundo, este es un mensaje de prueba."
    },
    "metadata": {
      "completionTime": "2025-07-18T14:43:30Z",
      "qualityScore": 0.98
    }
  }
}

// Failure
{
  "messageType": "TASK_ERROR",
  "payload": {
    "taskId": "task-123456",
    "contractId": "contract-789012",
    "status": "FAILED",
    "error": {
      "code": "PROCESSING_ERROR",
      "message": "Translation engine encountered an error with special characters",
      "details": {
        "errorLocation": "char 25-30",
        "suggestedAction": "Remove special characters and retry"
      }
    },
    "timestamp": "2025-07-18T14:35:15Z"
  }
}
```

### 5. Result Acknowledgment

The requester acknowledges receipt of the task result.

```json
{
  "messageType": "ACKNOWLEDGMENT",
  "payload": {
    "acknowledgedMessageId": "msg-result-123",
    "taskId": "task-123456",
    "contractId": "contract-789012",
    "status": "RECEIVED",
    "timestamp": "2025-07-18T14:44:00Z"
  }
}
```

## Task Cancellation

Either party can initiate task cancellation if needed.

```json
// Cancellation request
{
  "messageType": "TASK_CANCELLATION_REQUEST",
  "payload": {
    "taskId": "task-123456",
    "contractId": "contract-789012",
    "reason": "REQUESTER_DECISION",
    "message": "Task no longer needed",
    "timestamp": "2025-07-18T14:38:00Z"
  }
}

// Cancellation confirmation
{
  "messageType": "TASK_CANCELLATION_CONFIRMATION",
  "payload": {
    "taskId": "task-123456",
    "contractId": "contract-789012",
    "status": "CANCELED",
    "partialResults": {
      "translatedText": "Hola mundo, este es un..."
    },
    "timestamp": "2025-07-18T14:39:00Z"
  }
}
```

## Timeouts and Retry Handling

The H.I.V.E. Protocol includes mechanisms for handling timeouts and retries:

1. **Response Timeout**: If a provider doesn't respond to a proposal within a specified time, the requester can consider it implicitly rejected
2. **Execution Timeout**: If a task exceeds its deadline without completion, it can be automatically considered failed
3. **Update Frequency**: For long-running tasks, providers should send updates at agreed-upon intervals
4. **Retry Logic**: For transient failures, tasks can be automatically retried up to a specified limit

```json
// Retry notification
{
  "messageType": "TASK_RETRY",
  "payload": {
    "taskId": "task-123456",
    "contractId": "contract-789012",
    "previousAttemptId": "attempt-1",
    "currentAttemptId": "attempt-2",
    "retryReason": "TRANSIENT_ERROR",
    "timestamp": "2025-07-18T14:36:00Z"
  }
}
```

<Callout type="warning">
  Agents should implement proper timeout handling to prevent tasks from being stuck in intermediate states indefinitely.
</Callout>

## Task History and Auditability

The H.I.V.E. Protocol recommends maintaining a complete history of task state transitions for auditability:

```json
{
  "taskId": "task-123456",
  "history": [
    {
      "timestamp": "2025-07-18T14:30:00Z",
      "state": "PROPOSED",
      "actor": "agent-abc123",
      "details": { /* proposal details */ }
    },
    {
      "timestamp": "2025-07-18T14:31:00Z",
      "state": "ACCEPTED",
      "actor": "agent-xyz789",
      "details": { /* acceptance details */ }
    },
    {
      "timestamp": "2025-07-18T14:31:30Z",
      "state": "IN_PROGRESS",
      "actor": "agent-xyz789",
      "details": { /* progress details */ }
    },
    {
      "timestamp": "2025-07-18T14:43:30Z",
      "state": "COMPLETED",
      "actor": "agent-xyz789",
      "details": { /* completion details */ }
    }
  ]
}
```

## Implementation Considerations

When implementing the Task Lifecycle in your agent:

1. **State Management**: Maintain clear state tracking for all tasks
2. **Transactional Updates**: Ensure state transitions are atomic and consistent
3. **Timeout Handling**: Implement proper timeouts for each state
4. **Notification System**: Notify interested parties of state changes
5. **Error Recovery**: Design for graceful recovery from failures
6. **History Tracking**: Maintain an audit trail of state transitions

<Callout type="info">
  For a detailed specification of the message formats used during the task lifecycle, see the [Message Formats](/docs/protocol/structure/message-formats) documentation.
</Callout>
